:root{
  --bg:#0b0f16; --panel:#111826; --ink:#e9f1ff; --muted:#98a2b3;
  --accent:#ffd166; --house:#2b364a; --good:#7ee787;
}
*{ box-sizing:border-box; }
html,body{ margin:0; height:100%; background:var(--bg); color:var(--ink); font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; }

.hud, .foot{
  max-width:1100px; margin:12px auto; padding:8px 12px; display:flex; align-items:center; justify-content:space-between;
}
.hud .hint{ color:var(--muted); margin-left:.75rem; }
.stats{ display:flex; gap:1rem; color:var(--muted); }
.stats b{ color:var(--ink); }

#game{
  max-width:1100px; height:70vh; margin:10px auto; position:relative;
  border:1px solid #1d2637; border-radius:14px; overflow:hidden; background:linear-gradient(180deg,#0e1420,#0b0f16);
  box-shadow:0 20px 50px rgba(0,0,0,.35);
  display:grid; grid-template-columns: 1fr 1fr;
}
.lane{ position:relative; overflow:hidden; }
.lane-left{ background:linear-gradient(90deg,#131c2b 0%, #101828 100%); }
.lane-right{ background:linear-gradient(90deg,#0f1522 0%, #0e1a2a 100%); border-left:1px dashed #2a3550; }

/* People */
.person{
  position:absolute; width:42px; height:42px; border-radius:999px;
  background:radial-gradient(circle at 30% 30%, #fff 0 20%, var(--accent) 21% 60%, #d6a94b 61% 100%);
  border:2px solid #00000033; box-shadow:0 6px 16px rgba(0,0,0,.35);
  display:flex; align-items:center; justify-content:center; user-select:none; touch-action:none; cursor:grab;
}
.person:active{ cursor:grabbing; }
.person.small{ width:34px; height:34px; }
.person .emoji{ font-size:18px; }

/* Houses */
.houses-grid{
  --size: 110px;
  position:absolute; inset:0; display:grid; place-content:center; gap:16px;
  grid-template-columns: repeat(3, var(--size)); grid-auto-rows: var(--size);
}
.house{
  width:var(--size); height:var(--size); border-radius:12px; background:var(--house);
  border:2px solid #22304b; box-shadow: inset 0 0 0 2px #00000022, 0 10px 24px rgba(0,0,0,.25);
  display:grid; place-items:center; color:#cbd5e1; position:relative;
}
.house::before{ content:"üè†"; font-size:34px; filter:drop-shadow(0 2px 2px #0005); }
.house.filled{ background:#1e2639; border-color:#2f415f; }
.house.filled::before{ content:"üè°"; }
.house .slot{ position:absolute; inset:auto 8px 8px 8px; height:14px; border-radius:8px; background:#121a2b; overflow:hidden; }
.house .slot .bar{ height:100%; width:0%; background:linear-gradient(90deg,var(--good),#8ef0c0); transition:width .25s ease; }

/* Overlay */
.overlay{ position:absolute; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.55); backdrop-filter: blur(4px); }
.overlay.hidden{ display:none; }
.overlay .card{
  width:min(560px,90%); background:var(--panel); border:1px solid #202a41; border-radius:16px; padding:24px;
  text-align:center; box-shadow:0 16px 40px rgba(0,0,0,.45);
}
.overlay h2{ margin:0 0 8px; }
.overlay p{ color:var(--muted); margin:0 0 16px; }
.overlay button{
  padding:10px 16px; border-radius:10px; border:1px solid #2a3856; background:#1a2642; color:#e9f1ff; cursor:pointer;
}
.overlay button:hover{ background:#223255; }

/* Footer */
.foot{ color:var(--muted); opacity:.9; justify-content:center; }

/* Responsive */
@media (max-width:900px){
  #game{ height:72vh; }
  .houses-grid{ --size: 96px; gap:12px; }
}
@media (max-width:640px){
  #game{ grid-template-columns: 1fr; height:76vh; }
  .lane-right{ border-left:none; border-top:1px dashed #2a3550; }
  .hud{ flex-direction:column; gap:.5rem; align-items:flex-start; }
}





/* =======================
   STRESS METER + BG SHIFT
   ======================= */
:root {
  /* 210 (calm blue) ‚Üí 0 (red). JS updates this. */
  --stress-hue: 210;
}

/* If your background is on #game, use this. Otherwise move it to body */
#game {
  /* Smoothly shift toward red as hue decreases */
  background: radial-gradient(1200px 600px at 35% 15%,
              hsl(var(--stress-hue) 25% 16%) 0%,
              hsl(215 28% 8%) 70%,
              hsl(215 30% 6%) 100%);
  transition: background 300ms ease;
}

/* Stress meter container */
.stress-wrap {
  position: relative;
  width: clamp(220px, 40vw, 520px);
  height: 12px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 9999px;
  overflow: hidden;
  margin: .75rem 0 0;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
}

/* The filling bar */
#stressBar {
  width: 0%;
  height: 100%;
  background: linear-gradient(90deg, #FF8A80, #FF5252, #FF1744);
  box-shadow: 0 0 8px rgba(255,82,82,.55);
  transition: width 180ms linear;
}

/* Label over the meter */
.stress-label {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%,-50%);
  font-size: .75rem;
  color: rgba(255,255,255,0.85);
  pointer-events: none;
}
/* =======================
   END STRESS METER + BG SHIFT
   ======================= */